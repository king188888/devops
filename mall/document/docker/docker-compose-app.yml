
services:
  mall-admin:
    image: mall/mall-admin:1.0-SNAPSHOT
    container_name: mall-admin
    ports:
      - 8080:8080
    volumes:
      - /mydata/app/mall-admin/logs:/var/logs
      - /etc/localtime:/etc/localtime
    environment:
      - 'TZ="Asia/Shanghai"'
      - 'SPRING_PROFILES_ACTIVE=dev'
    networks:
      - docker_db-net #可以用db这个域名访问mysql服务
  mall-search:
    image: mall/mall-search:1.0-SNAPSHOT
    container_name: mall-search
    ports:
      - 8081:8081
    volumes:
      - /mydata/app/mall-search/logs:/var/logs
      - /etc/localtime:/etc/localtime
    environment:
      - 'TZ="Asia/Shanghai"'
    networks:
      - docker_logging-net #可以用es这个域名访问elasticsearch服务
      - docker_db-net #可以用db这个域名访问mysql服务
  mall-portal:
    image: mall/mall-portal:1.0-SNAPSHOT
    container_name: mall-portal
    ports:
      - 8085:8085
    volumes:
      - /mydata/app/mall-portal/logs:/var/logs
      - /etc/localtime:/etc/localtime
    environment:
      - 'TZ="Asia/Shanghai"'
    networks:
      - docker_db-net #可以用redis、mango这个域名访问redis服务
      - docker_middleware-net #可以用rabbit这个域名访问rabbitmq服务

  busybox:
    image: busybox:latest
    command: sh -c "while true; do sleep 3600; done"
    networks:
      - docker_db-net
      - docker_middleware-net
      - docker_logging-net
      - docker_frontend-net

networks:
  docker_db-net:
    external: true
  docker_middleware-net:
    external: true
  docker_logging-net:
    external: true
  docker_frontend-net:
    external: true